<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>ResultsPanel Tests</title>

    <!-- META TAGS -->
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="../../dijit/themes/claro/claro.css" />
    <link rel="stylesheet" type="text/css" href="../../esri/css/esri.css" />
    <link rel="stylesheet" href="../../bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="../resources/App.css">
    <link rel="stylesheet" href="../resources/ResultsPanel.css">
    <style type='text/css'>

    </style>

    <!-- JAVASCRIPT -->
    <script>
        dojoConfig = {
            async: false
        };
    </script>
    <script type="text/javascript" src="../../highcharts-release/adapters/standalone-framework.js"></script>
    <!-- <script type="text/javascript" src="../../highcharts-release/highcharts.js"></script> -->
    <script type='text/javascript' src="../../dojo/dojo.js"></script>
    <script type="text/javascript">
        var baseUrl = window.location.pathname.replace(/\/[^\/]+$/, '') + '/' + '../../';
        var widgetUnderTest;

        require({
            baseUrl: baseUrl,
            packages: ['app', 'esri', 'dojo', 'dijit', 'dojox', 'xstyle', {
                name: 'highcharts',
                location: './highcharts-release',
                main: 'highcharts'
            }]
        }, [
            'app/ResultsPanel',

            'dojo/on',
            'dojo/query',
            'dojo/Deferred',
            'dojo/dom-class',

            'dojo/domReady!'
        ], function(Module, on, query, Deferred, domClass) {
            widgetUnderTest = new Module({
            }, 'node');

            widgetUnderTest.startup();

            query('#compare').on('click', function(){
                domClass.remove(widgetUnderTest.domNode, 'hidden');
                var x = new Deferred();

                widgetUnderTest.getChartData = function(){
                   return x.promise;
                };

                widgetUnderTest.show();
                widgetUnderTest.displayChartsFor({
                    source : {
                        date: {

                            fromTime: '13:04',
                            toTime: '16:04'
                        }
                    },
                    compare : {
                        date: {
                            fromTime: '13:04',
                            toTime: '16:04'
                        }
                    }
                });

                setTimeout(function(){
                    x.resolve({
                        "weather": {
                            "categories": [
                                    "Blowing Sand, Soil, Dirt",
                                    "Blowing Snow",
                                    "Clear",
                                    "Cloudy",
                                    "Fog, Smog",
                                    "Rain"
                            ],
                            "series": [{
                                "type": "bar",
                                "data": [
                                    [
                                        29
                                    ],
                                    [
                                        342
                                    ],
                                    [
                                        66624
                                    ],
                                    [
                                        14656
                                    ],
                                    [
                                        330
                                    ],
                                    [
                                        4359
                                    ]
                                ]},{
                                    "type": "bar",
                                    "data": [
                                        [
                                            9
                                        ],
                                        [
                                            1342
                                        ],
                                        [
                                            56624
                                        ],
                                        [
                                            4656
                                        ],
                                        [
                                            1330
                                        ],
                                        [
                                            359
                                        ]
                                    ]}
                                ],
                                "selector": "weather"
                        },
                        "road": {
                            "categories":[
                                    "Dry",
                                    "Ice",
                                    "Mud",
                                    "Oil"
                            ],
                            "series": [{
                            "type": "bar",
                            "data": [
                                [
                                    75766
                                ],
                                [
                                    2991
                                ],
                                [
                                    40
                                ],
                                [
                                    9
                                ]
                            ]},{
                            "type": "bar",
                            "data": [
                                [
                                    175766
                                ],
                                [
                                    1991
                                ],
                                [
                                    4
                                ],
                                [
                                    19
                                ]
                            ]}],
                            "selector": "road"
                        },
                        "cause": {
                            "categories": [
                                    "Disregard Road Markings",
                                    "Disregard Traffic Signals",
                                    "Disregard Traffic Signs",
                                    "Exceeded Posted Speed Limit"
                            ],
                            "series":[{
                            "type": "bar",
                            "name": "Original",
                            "center": ["20%"],
                            "data": [
                                [
                                    "Disregard Road Markings",
                                    121
                                ],
                                [
                                    3071
                                ],
                                [
                                    1024
                                ],
                                [
                                    864
                                ]
                            ]},{
                            "type": "bar",
                            "name": "Comparison",
                            "center": ["80%"],
                            "data": [
                                [
                                    "Disregard Road Markings",
                                    1211
                                ],
                                [
                                    2071
                                ],
                                [
                                    5024
                                ],
                                [
                                    64
                                ]
                            ]}],
                            "selector": "factors"
                        },
                        "distraction": {
                            "categories": [
                                "Cell Phone",
                                "None",
                                "Other Electronic Device",
                                "Other External",
                                "Other Inside",
                                "Passengers",
                                "Radio / CD / DVD etc.",
                                "Texting",
                                "TV / Monitor"
                            ],
                            "series": [{
                                    "name": "distraction",
                                    "type": "bar",
                                        "data": [
                                        [
                                            132
                                        ],
                                        [
                                            13619
                                        ],
                                        [
                                            24
                                        ],
                                        [
                                            136
                                        ],
                                        [
                                            133
                                        ],
                                        [
                                            113
                                        ],
                                        [
                                            77
                                        ],
                                        [
                                            5
                                        ],
                                        [
                                            2
                                        ]
                                    ]},{
                                    "name": "comparison",
                                    "type": "bar",
                                    "data": [
                                        [
                                            1329
                                        ],
                                        [
                                            136619
                                        ],
                                        [
                                            241
                                        ],
                                        [
                                            1036
                                        ],
                                        [
                                            1133
                                        ],
                                        [
                                            1113
                                        ],
                                        [
                                            737
                                        ],
                                        [
                                            25
                                        ],
                                        [
                                            4
                                        ]
                                    ]}
                            ],
                            "selector": "distractions"
                        },
                        "time": {
                            "categories":[
                                0,1,2,3,4,5,6,7,8,9,10,11,12,14,15,16,17,18,19,20,21,22,23
                            ],
                            "series": [{
                            "data": [
                                [
                                    0,
                                    1086
                                ],
                                [
                                    1,
                                    821
                                ],
                                [
                                    2,
                                    608
                                ],
                                [
                                    3,
                                    465
                                ],
                                [
                                    4,
                                    631
                                ],
                                [
                                    5,
                                    1340
                                ],
                                [
                                    6,
                                    2433
                                ],
                                [
                                    7,
                                    5062
                                ],
                                [
                                    8,
                                    5520
                                ],
                                [
                                    9,
                                    4100
                                ],
                                [
                                    10,
                                    3655
                                ],
                                [
                                    11,
                                    4324
                                ],
                                [
                                    12,
                                    5358
                                ],
                                [
                                    13,
                                    5390
                                ],
                                [
                                    14,
                                    6139
                                ],
                                [
                                    15,
                                    7391
                                ],
                                [
                                    16,
                                    7812
                                ],
                                [
                                    17,
                                    9517
                                ],
                                [
                                    18,
                                    7034
                                ],
                                [
                                    19,
                                    4521
                                ],
                                [
                                    20,
                                    3246
                                ],
                                [
                                    21,
                                    3200
                                ],
                                [
                                    22,
                                    2512
                                ],
                                [
                                    23,
                                    1756
                                ]
                            ]},{
                            "data": [
                                [
                                    0,
                                    186
                                ],
                                [
                                    2,
                                    808
                                ],
                                [
                                    3,
                                    265
                                ],
                                [
                                    4,
                                    1631
                                ],
                                [
                                    5,
                                    340
                                ],
                                [
                                    6,
                                    233
                                ],
                                [
                                    7,
                                    7062
                                ],
                                [
                                    8,
                                    520
                                ],
                                [
                                    9,
                                    400
                                ],
                                [
                                    10,
                                    3655
                                ],
                                [
                                    11,
                                    4324
                                ],
                                [
                                    12,
                                    5358
                                ],
                                [
                                    13,
                                    5390
                                ],
                                [
                                    14,
                                    6139
                                ],
                                [
                                    15,
                                    7391
                                ],
                                [
                                    16,
                                    7812
                                ],
                                [
                                    17,
                                    9517
                                ],
                                [
                                    18,
                                    7034
                                ],
                                [
                                    19,
                                    4521
                                ],
                                [
                                    20,
                                    3246
                                ],
                                [
                                    21,
                                    3200
                                ],
                                [
                                    22,
                                    2512
                                ],
                                [
                                    23,
                                    1756
                                ]
                            ]}],
                            "type": "line",
                            "selector": "time"
                        }

                    });
                    }, 1000);

                });

            query('#fetch').on('click', function(){
                domClass.remove(widgetUnderTest.domNode, 'hidden');
                var x = new Deferred();

                widgetUnderTest.getChartData = function(){
                   return x.promise;
                };

                widgetUnderTest.show();
                widgetUnderTest.displayChartsFor({
                    source : {
                        date: {
                            fromDate: '2013-01-23',
                            toDate: '2014-02-23',
                            fromTime: '13:04',
                            toTime: '16:04'
                        }
                    }
                });

                setTimeout(function(){x.resolve({
                    "weather": {
                        "series": [{
                            "type": "pie",
                            "data": [
                                [
                                    "Blowing Sand, Soil, Dirt",
                                    29
                                ],
                                [
                                    "Blowing Snow",
                                    342
                                ],
                                [
                                    "Clear",
                                    66624
                                ],
                                [
                                    "Cloudy",
                                    14656
                                ],
                                [
                                    "Fog, Smog",
                                    330
                                ],
                                [
                                    "Rain",
                                    4359
                                ],
                                [
                                    "Severe Crosswinds",
                                    133
                                ],
                                [
                                    "Sleet, Hail",
                                    268
                                ],
                                [
                                    "Snowing",
                                    5496
                                ]
                            ]}],
                            "selector": "weather"
                    },
                    "road": {
                        "series": [{
                        "type": "pie",
                        "data": [
                            [
                                "Dry",
                                75766
                            ],
                            [
                                "Ice",
                                2991
                            ],
                            [
                                "Mud",
                                40
                            ],
                            [
                                "Oil",
                                9
                            ],
                            [
                                "Sand, Dirt, Gravel",
                                403
                            ],
                            [
                                "Slush",
                                1277
                            ],
                            [
                                "Snow",
                                4008
                            ],
                            [
                                "Water (standing,moving)",
                                107
                            ],
                            [
                                "Wet",
                                7678
                            ]
                        ]}],
                        "selector": "road"
                    },
                    "cause": {
                        "series":[{
                        "type": "pie",
                        "data": [
                            [
                                "Disregard Road Markings",
                                121
                            ],
                            [
                                "Disregard Traffic Signals",
                                3071
                            ],
                            [
                                "Disregard Traffic Signs",
                                1024
                            ],
                            [
                                "Exceeded Posted Speed Limit",
                                864
                            ],
                            [
                                "Failed to Keep in Proper Lane",
                                7565
                            ],
                            [
                                "Failed to Yield Right-of-Way",
                                15284
                            ],
                            [
                                "Followed Too Closely",
                                21681
                            ],
                            [
                                "Hit and Run",
                                2004
                            ],
                            [
                                "Improper Backing",
                                2165
                            ],
                            [
                                "Improper Lane Change",
                                3211
                            ],
                            [
                                "Improper Parking/Stopping",
                                1111
                            ],
                            [
                                "Improper Passing",
                                602
                            ],
                            [
                                "Improper Signal",
                                107
                            ],
                            [
                                "Improper Turn",
                                3351
                            ],
                            [
                                "None",
                                79667
                            ],
                            [
                                "Over-Correcting/Over-Steering",
                                871
                            ],
                            [
                                "Ran Off Road",
                                1692
                            ],
                            [
                                "Reckless/Aggressive",
                                611
                            ],
                            [
                                "Street Racing",
                                14
                            ],
                            [
                                "Swerved or Evassive Action",
                                1626
                            ],
                            [
                                "Too Fast for Conditions",
                                8613
                            ],
                            [
                                "Wrong Side/Wrong Way",
                                286
                            ]
                        ]}],
                        "selector": "factors"
                    },
                    "distraction": {
                        "categories": [
                            "Cell Phone",
                            "None",
                            "Other Electronic Device",
                            "Other External",
                            "Other Inside",
                            "Passengers",
                            "Radio / CD / DVD etc.",
                            "Texting",
                            "TV / Monitor"
                        ],
                        "series": [{
                        "type": "bar",
                        "data": [
                            [
                                "Cell Phone",
                                1329
                            ],
                            [
                                "None",
                                136619
                            ],
                            [
                                "Other Electronic Device",
                                241
                            ],
                            [
                                "Other External",
                                1036
                            ],
                            [
                                "Other Inside",
                                1133
                            ],
                            [
                                "Passengers",
                                1113
                            ],
                            [
                                "Radio / CD / DVD etc.",
                                737
                            ],
                            [
                                "Texting",
                                25
                            ],
                            [
                                "TV / Monitor",
                                4
                            ]
                        ]}],
                        "selector": "distractions"
                    },
                    "day": {
                        "series": [{
                        "type": "bar",
                        "data": [
                            [
                                "Monday",
                                29268
                            ],
                            [
                                "Thursday",
                                31542
                            ],
                            [
                                "Friday",
                                33111
                            ]
                        ]}],
                        "categories": [
                            "Monday",
                            "Thursday",
                            "Friday"
                        ],
                        "selector": "days"
                    },
                    "time": {
                        "series": [{
                        "type": "line",
                        "data": [
                            [
                                0,
                                1086
                            ],
                            [
                                1,
                                821
                            ],
                            [
                                2,
                                608
                            ],
                            [
                                3,
                                465
                            ],
                            [
                                4,
                                631
                            ],
                            [
                                5,
                                1340
                            ],
                            [
                                6,
                                2433
                            ],
                            [
                                7,
                                5062
                            ],
                            [
                                8,
                                5520
                            ],
                            [
                                9,
                                4100
                            ],
                            [
                                10,
                                3655
                            ],
                            [
                                11,
                                4324
                            ],
                            [
                                12,
                                5358
                            ],
                            [
                                13,
                                5390
                            ],
                            [
                                14,
                                6139
                            ],
                            [
                                15,
                                7391
                            ],
                            [
                                16,
                                7812
                            ],
                            [
                                17,
                                9517
                            ],
                            [
                                18,
                                7034
                            ],
                            [
                                19,
                                4521
                            ],
                            [
                                20,
                                3246
                            ],
                            [
                                21,
                                3200
                            ],
                            [
                                22,
                                2512
                            ],
                            [
                                23,
                                1756
                            ]
                        ]}],
                        "type": "line",
                        "selector": "time"
                    }
                })}, 1000);
            })
        });
</script>
</head>
<body class='claro'>
    <div class="center-container">
    <div id="node" class='container-fluid'></div>
    </div>
    <button id="fetch">Show first chart</button>
    <button id="compare">Compare Charts</button>
</body>
</html>
